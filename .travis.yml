os:
- linux
language: nix

env:
- LANG=C.utf8

script:
- nix-build
- mkdir -p site
- |-
  ./result/bin/ComiCal \
      --dc-issues         batman-white-knight-presents-harley-quinn-2020 \
      --dc-issues         catwoman-2018 \
      --dc-issues         john-constantine-hellblazer-2019 \
      --dc-issues         hellblazer-rise-and-fall-2020 \
      --dc-issues         strange-adventures-2020 \
      --dc-issues         sweet-tooth-the-return-2020 \
      --image-collections gideon-falls \
      --image-collections lazarus \
      --image-collections pretty-deadly \
      --image-collections southern-bastards \
      --image-collections the-fix \
      --image-issues      ascender \
      --image-issues      bliss \
      --image-issues      family-tree \
      --image-issues      nailbiter \
      --image-issues      oblivion-song-by-kirkman-de-felici \
      --image-issues      spawn \
      --image-issues      the-department-of-truth \
      >site/comics.ics

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  keep_history: true
  target_branch: gh-pages
  local_dir: site
  on:
    branch: main
